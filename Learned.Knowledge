# Learned Knowledge

- 2026-01-17: macOS debug builds use JIT entitlements. If debug launches fail with amfid provisioning-profile errors, ensure Xcode automatic signing creates a Mac Development provisioning profile. As a workaround, profile mode runs without JIT.
- 2026-01-17: `macos/Runner/DebugProfile.entitlements` sets `com.apple.security.get-task-allow` to false to reduce provisioning profile validation needs; set to true if LLDB attach is required.
- 2026-01-18: Added taxonomy mapping for providers: `branches`/`categories` now carry `status` and `normalized_name`, with `company_branches`/`company_categories` join tables for filtering and approvals; buyers can create pending branch/category terms via the branches API, consultants can approve/decline.
- 2026-01-19: Local Docker engine is Rancher Desktop (moby); set Docker context to `rancher-desktop` for local development instead of Docker Desktop.
- 2026-01-19: Provider taxonomy assignments now surface in API/UI via `branchAssignments`/`categoryAssignments` and `GET/PUT /providers/{companyId}/taxonomy`; manual edits replace AI rows (source `manual`, status `active`), AI rows use `source=openai` with confidence.
- 2026-01-19: Enrichment migration requires companies to exist; seed local DB (seed_database) before `supabase migration up` to avoid FK errors. Use `--include-existing` when generating enrichment SQL to insert branches/categories even if in reference files.
- 2026-01-19: `seed_database.dart` supports `--skip-taxonomy` to leave taxonomy tables empty so the enrichment migration is the sole source of branch/category data.
- 2026-01-19: Taxonomy normalization now folds diacritics for branch/category names; cleanup pipeline uses `seed-data/etl/bin/cleanup_taxonomy.dart` to merge duplicates and regenerate enrichment data with new IDs.
- 2026-01-20: Multi-company access is modeled via `user_company_roles` with `users.last_login_company_id` for active context; role switching now accepts `companyId` and `/Users/loadUserWithCompany` returns company options for the UI switcher.
- 2026-01-20: Summary PDFs are generated via `POST /inquiries/{id}/pdf/generate` and `/offers/{id}/pdf/generate`, stored in Supabase storage with `summary_pdf_path`, and the UI can generate/open signed URLs on demand.
